INTEGER*4  LEI%,  GRA%,   NEX%

OPEN "C:\ADX_UDT1\T5150201.DAT" AS 1
OPEN "EAMFBACT" KEYED RECL 101 AS 2
CLEARS
PRINT : PRINT : PRINT : PRINT 
PRINT "          Programa para Acumular Puntos/Periodo a Puntos/Totales"
IF END #1 THEN SALIR
ON ERROR GOTO RUTER
LEER:
READ #1;LINE REG$ 
LEI%  = LEI% + 1
KEY$ = PACK$(RIGHT$(STRING$(18,"0")+LEFT$(REG$,9),18))
PUNT% = VAL(RIGHT$(REG$,14))
EOF$ = "  "
READ FORM "C9 C4 C88";#2 KEY KEY$;KEY$,PUNA$,REST$
IF EOF$ = "  " THEN BEGIN
   GRA% = GRA% + 1
   PUNA$ = PACK$(RIGHT$("00000000" + STR$(VAL(UNPACK$(PUNA$))+PUNT%),8))
   WRITE FORM "C9 C4 C88";#2;KEY$,PUNA$,REST$
ENDIF ELSE BEGIN
   NEX% = NEX% + 1
ENDIF
LOCATE 10,5  :  PRINT "    Le¡dos: ";LEI%
LOCATE 11,5  :  PRINT "  Grabados: ";GRA%
LOCATE 12,5  :  PRINT "No Existen: ";NEX%
GOTO LEER

RUTER:
EOF$ = ERR
IF ERR = "EF" AND ERRF% = 1 THEN RESUME
SALIR:
close 1 : close 2
STOP
