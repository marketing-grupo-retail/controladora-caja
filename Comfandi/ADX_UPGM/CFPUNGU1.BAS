INTEGER*4  LEI%,  GRA%,   NEX%

OPEN "C:\EAMFBAPP.008" DIRECT RECL 36 AS 1
OPEN "EAMFBACT" KEYED RECL 101 AS 2
CLEARS
PRINT : PRINT : PRINT : PRINT 
PRINT "          Programa para DEPURAR  Puntos/Mes a Puntos/Totales"

IF END #1 THEN SALIR
ON ERROR GOTO RUTER
LEER:
LEI%  = LEI% + 1
READ FORM "C9 C10 C4 C13";#1,LEI%;KEY$,PART1$,PUNP$,PART2$

PUNT% = VAL(UNPACK$(PUNP$))
EOF$ = "  "
READ FORM "C9 C4 C41 C4 C43";#2 KEY KEY$;KEY$,PUNA$,REST1$,PUNP1$,REST$
IF EOF$ = "  " THEN BEGIN
   GRA% = GRA% + 1
   PUNA$ =  PACK$(RIGHT$("00000000" + STR$(VAL(UNPACK$(PUNA$)) +PUNT%),8))
   WRITE FORM "C9 C4 C41 C4 C43";#2;KEY$,PUNA$,REST1$,PUNP1$,REST$
ENDIF ELSE BEGIN
   NEX% = NEX% + 1
ENDIF
LOCATE 10,5  :  PRINT "    Le¡dos: ";LEI%
LOCATE 11,5  :  PRINT "  Grabados: ";GRA%
LOCATE 12,5  :  PRINT "No Existen: ";NEX%
LOCATE 13,5  :  PRINT "Cuenta No : ";unpack$(key$)
LOCATE 14,5  :  PRINT "puntos per: ";unpack$(punp1$)

GOTO LEER

RUTER:
EOF$ = ERR
IF ERR = "EF" AND ERRF% = 2 THEN RESUME
PRINT "ERROR "; ERR;"  FILE ";ERRF%
SALIR:
close 1 : close 2
STOP
