!   ***************************************************************************
!   **    Date       :  Octubre 27 / 97                                      **
!   **    Responsable:  DEPTO DE SISTEMAS                                    **
!   **    User Exit  :  USRSU03.011                                          **
!   **    Inclu¡r en :  EAMTSUSU.J86                                         **
!   **    Program    :  EAMTSUPC.BAS                                         **
!   **    Executable :  EAMTS10L.286                                         **
!   **        Ajuste :  SISTEMAS POS                                         **
!   **                                                                       **
!   **    Instrucciones  para  franqueo de documentos con el nombre del      **
!   **    CLIENTE y el nombre de la Empresa para Ventas a Credito.           **
!   **    Ademas imprime tiquete doble Minifactura.                          **
!   ***************************************************************************
!
!---------------- Subrutina de Impresi¢n  ----------------------------- 
SUB IMPRIMIR                                             ! Subrut de Vendedor
     
     FOR USR.IND1% = 1 TO 499                            ! Loop para vaciar CR
        IF USR.ITEMS$(USR.IND1%) = "" THEN BEGIN         ! Si no hay mas lineas
           IF LINMF% > 0 THEN BEGIN                      ! Si faltan lineas
!              FOR UE.II% = LINMF% TO 0 STEP -1           ! completa con blancos
!                  CALL U.IMPRIMIR("*"+"---*",4100H)
!              NEXT UE.II%                                   ! Siguiente Loop

           ENDIF                                          ! Fin de Condic

!--- Ajuste string de impresion OVS - ASIC 10 Ago 2005
           
           FOR USR.IND1% = 450 TO 489                     ! Loop para vaciar TOT

!               IF USR.ITEMS$(USR.IND1%) <> "" THEN BEGIN  ! Si hay Pagos
!                  TS.TEMP3$ = LEFT$(USR.ITEMS$(USR.IND1%),38-(38-LEN(USR.ITEMS$(USR.IND1%))))
!                  TS.TEMP3$ = LEFT$(TS.TEMP3$+STRING$(38," "),38)
!		              CALL U.IMPRIMIR(TS.TEMP3$,4100H)        ! agoten
!               ENDIF                                      ! Fin de los Pagos

           NEXT USR.IND1%                                 ! Sig Loop
           
           USR.IND1% = 499                                ! Asigna final Loop
        ENDIF ELSE BEGIN                                  !
          CAB1$ = "                       " +            \!
                 MID$(USR.ITEMS$(USR.IND1%),47,3)  +     \! Cantidad
                 RIGHT$(USR.ITEMS$(USR.IND1%),11)         ! Valor Total
                 
                 CALL U.IMPRIMIR(MID$(USR.ITEMS$(USR.IND1%),5,7)   +    \! Codigo extendido 
                 MID$(USR.ITEMS$(USR.IND1%),17,17) +    \ ! Descripcion
                 MID$(USR.ITEMS$(USR.IND1%),53,12),4100H)       ! Cantidad

           CALL U.IMPRIMIR(CAB1$,4100H)
           LINMF% = LINMF% - 2                            ! Decrem Cont Linea
        ENDIF                                             !
      NEXT USR.IND1%                                      !
      NOM$ = STRING$(30," ")                              ! Borra Nombre

END SUB                                                  ! Fin Subrutina
!----------------------------------------------------------------------------
